{"ast":null,"code":"import cloneDeep from 'lodash/cloneDeep';\nimport qs from 'qs';\nimport isPlainObject from 'lodash/isPlainObject';\nimport { platform, release } from 'os';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar attempts = {};\nvar networkErrorAttempts = 0;\n\nfunction rateLimit(instance) {\n  var maxRetry = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  var _instance$defaults = instance.defaults,\n      _instance$defaults$re = _instance$defaults.responseLogger,\n      responseLogger = _instance$defaults$re === void 0 ? function () {\n    return undefined;\n  } : _instance$defaults$re,\n      _instance$defaults$re2 = _instance$defaults.requestLogger,\n      requestLogger = _instance$defaults$re2 === void 0 ? function () {\n    return undefined;\n  } : _instance$defaults$re2;\n  instance.interceptors.request.use(function (config) {\n    requestLogger(config);\n    return config;\n  }, function (error) {\n    return Promise.reject(error);\n  });\n  instance.interceptors.response.use(function (response) {\n    // we don't need to do anything here\n    responseLogger(response);\n    return response;\n  }, function (error) {\n    var response = error.response,\n        config = error.config; // Do not retry if it is disabled or no request config exists (not an axios error)\n\n    if (!config || !instance.defaults.retryOnError) {\n      return Promise.reject(error);\n    }\n\n    var retryErrorType = null;\n    var wait = 0; // Errors without response did not recieve anything from the server\n\n    if (!response) {\n      retryErrorType = 'Connection';\n      networkErrorAttempts++;\n\n      if (networkErrorAttempts > maxRetry) {\n        error.attempts = networkErrorAttempts;\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, networkErrorAttempts);\n      response = {};\n    } else {\n      networkErrorAttempts = 0;\n    }\n\n    if (response.status >= 500 && response.status < 600) {\n      // 5** errors are server related\n      retryErrorType = \"Server \".concat(response.status);\n      var headers = response.headers || {};\n      var requestId = headers['x-contentful-request-id'] || null;\n      attempts[requestId] = attempts[requestId] || 0;\n      attempts[requestId]++; // we reject if there are too many errors with the same request id or request id is not defined\n\n      if (attempts[requestId] > maxRetry || !requestId) {\n        error.attempts = attempts[requestId];\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, attempts[requestId]);\n    } else if (response.status === 429) {\n      // 429 errors are exceeded rate limit exceptions\n      retryErrorType = 'Rate limit'; // all headers are lowercased by axios https://github.com/mzabriskie/axios/issues/413\n\n      if (response.headers && error.response.headers['x-contentful-ratelimit-reset']) {\n        wait = response.headers['x-contentful-ratelimit-reset'];\n      }\n    }\n\n    var delay = function delay(ms) {\n      return new Promise(function (resolve) {\n        setTimeout(resolve, ms);\n      });\n    };\n\n    if (retryErrorType) {\n      // convert to ms and add jitter\n      wait = Math.floor(wait * 1000 + Math.random() * 200 + 500);\n      instance.defaults.logHandler('warning', \"\".concat(retryErrorType, \" error occurred. Waiting for \").concat(wait, \" ms before retrying...\"));\n      /* Somehow between the interceptor and retrying the request the httpAgent/httpsAgent gets transformed from an Agent-like object\n         to a regular object, causing failures on retries after rate limits. Removing these properties here fixes the error, but retry\n         requests still use the original http/httpsAgent property */\n\n      delete config.httpAgent;\n      delete config.httpsAgent;\n      return delay(wait).then(function () {\n        return instance(config);\n      });\n    }\n\n    return Promise.reject(error);\n  });\n}\n\nfunction isNode() {\n  /**\n   * Polyfills of 'process' might set process.browser === true\n   *\n   * See:\n   * https://github.com/webpack/node-libs-browser/blob/master/mock/process.js#L8\n   * https://github.com/defunctzombie/node-process/blob/master/browser.js#L156\n  **/\n  return typeof process !== 'undefined' && !process.browser;\n}\n\nfunction getNodeVersion() {\n  return process.versions && process.versions.node ? \"v\".concat(process.versions.node) : process.version;\n} // Also enforces toplevel domain specified, no spaces and no protocol\n\n\nvar HOST_REGEX = /^(?!\\w+:\\/\\/)([^\\s:]+\\.?[^\\s:]+)(?::(\\d+))?(?!:)$/;\n/**\n * Create pre configured axios instance\n * @private\n * @param {Object} axios - Axios library\n * @param {Object} httpClientParams - Initialization parameters for the HTTP client\n * @prop {string} space - Space ID\n * @prop {string} accessToken - Access Token\n * @prop {boolean=} insecure - If we should use http instead\n * @prop {string=} host - Alternate host\n * @prop {Object=} httpAgent - HTTP agent for node\n * @prop {Object=} httpsAgent - HTTPS agent for node\n * @prop {function=} adapter - Axios adapter to handle requests\n * @prop {function=} requestLogger - Gets called on every request triggered by the SDK, takes the axios request config as an argument\n * @prop {function=} responseLogger - Gets called on every response, takes axios response object as an argument\n * @prop {Object=} proxy - Axios proxy config\n * @prop {Object=} headers - Additional headers\n * @prop {function=} logHandler - A log handler function to process given log messages & errors. Receives the log level (error, warning & info) and the actual log data (Error object or string). (Default can be found here: https://github.com/contentful/contentful-sdk-core/blob/master/lib/create-http-client.js)\n * @return {Object} Initialized axios instance\n */\n\nfunction createHttpClient(axios, options) {\n  var defaultConfig = {\n    insecure: false,\n    retryOnError: true,\n    logHandler: function logHandler(level, data) {\n      if (level === 'error' && data) {\n        var title = [data.name, data.message].filter(function (a) {\n          return a;\n        }).join(' - ');\n        console.error(\"[error] \".concat(title));\n        console.error(data);\n        return;\n      }\n\n      console.log(\"[\".concat(level, \"] \").concat(data));\n    },\n    // Passed to axios\n    headers: {},\n    httpAgent: false,\n    httpsAgent: false,\n    timeout: 30000,\n    proxy: false,\n    basePath: '',\n    adapter: false,\n    maxContentLength: 1073741824 // 1GB\n\n  };\n\n  var config = _objectSpread2({}, defaultConfig, {}, options);\n\n  if (!config.accessToken) {\n    var missingAccessTokenError = new TypeError('Expected parameter accessToken');\n    config.logHandler('error', missingAccessTokenError);\n    throw missingAccessTokenError;\n  } // Construct axios baseURL option\n\n\n  var protocol = config.insecure ? 'http' : 'https';\n  var space = config.space ? \"\".concat(config.space, \"/\") : '';\n  var hostname = config.defaultHostname;\n  var port = config.insecure ? 80 : 443;\n\n  if (config.host && HOST_REGEX.test(config.host)) {\n    var parsed = config.host.split(':');\n\n    if (parsed.length === 2) {\n      var _parsed = _slicedToArray(parsed, 2);\n\n      hostname = _parsed[0];\n      port = _parsed[1];\n    } else {\n      hostname = parsed[0];\n    }\n  } // Ensure that basePath does start but not end with a slash\n\n\n  if (config.basePath) {\n    config.basePath = \"/\".concat(config.basePath.split('/').filter(Boolean).join('/'));\n  }\n\n  var baseURL = options.baseURL || \"\".concat(protocol, \"://\").concat(hostname, \":\").concat(port).concat(config.basePath, \"/spaces/\").concat(space);\n\n  if (!config.headers['Authorization']) {\n    config.headers['Authorization'] = 'Bearer ' + config.accessToken;\n  } // Set these headers only for node because browsers don't like it when you\n  // override user-agent or accept-encoding.\n  // The SDKs should set their own X-Contentful-User-Agent.\n\n\n  if (isNode()) {\n    config.headers['user-agent'] = 'node.js/' + getNodeVersion();\n    config.headers['Accept-Encoding'] = 'gzip';\n  }\n\n  var axiosOptions = {\n    // Axios\n    baseURL: baseURL,\n    headers: config.headers,\n    httpAgent: config.httpAgent,\n    httpsAgent: config.httpsAgent,\n    paramsSerializer: qs.stringify,\n    proxy: config.proxy,\n    timeout: config.timeout,\n    adapter: config.adapter,\n    maxContentLength: config.maxContentLength,\n    // Contentful\n    logHandler: config.logHandler,\n    responseLogger: config.responseLogger,\n    requestLogger: config.requestLogger,\n    retryOnError: config.retryOnError\n  };\n  var instance = axios.create(axiosOptions);\n  instance.httpClientParams = options;\n  /**\n   * Creates a new axios instance with the same default base parameters as the\n   * current one, and with any overrides passed to the newParams object\n   * This is useful as the SDKs use dependency injection to get the axios library\n   * and the version of the library comes from different places depending\n   * on whether it's a browser build or a node.js build.\n   * @private\n   * @param {Object} httpClientParams - Initialization parameters for the HTTP client\n   * @return {Object} Initialized axios instance\n   */\n\n  instance.cloneWithNewParams = function (newParams) {\n    return createHttpClient(axios, _objectSpread2({}, cloneDeep(options), {}, newParams));\n  };\n\n  rateLimit(instance, config.retryLimit);\n  return instance;\n}\n/**\n * Creates request parameters configuration by parsing an existing query object\n * @private\n * @param {Object} query\n * @return {Object} Config object with `params` property, ready to be used in axios\n */\n\n\nfunction createRequestConfig(_ref) {\n  var query = _ref.query;\n  var config = {};\n  delete query.resolveLinks;\n  config.params = cloneDeep(query);\n  return config;\n}\n\nfunction enforceObjPath(obj, path) {\n  if (!(path in obj)) {\n    var err = new Error();\n    err.name = 'PropertyMissing';\n    err.message = \"Required property \".concat(path, \" missing from:\\n\\n\").concat(JSON.stringify(obj), \"\\n\\n\");\n    throw err;\n  }\n\n  return true;\n}\n\nfunction freezeObjectDeep(obj) {\n  Object.keys(obj).forEach(function (key) {\n    var value = obj[key];\n\n    if (isPlainObject(value)) {\n      freezeObjectDeep(value);\n    }\n  });\n  return Object.freeze(obj);\n}\n\nfunction freezeSys(obj) {\n  freezeObjectDeep(obj.sys || {});\n  return obj;\n}\n\nfunction isReactNative() {\n  return typeof window !== 'undefined' && 'navigator' in window && 'product' in window.navigator && window.navigator.product === 'ReactNative';\n}\n\nfunction getBrowserOS() {\n  if (!window) {\n    return null;\n  }\n\n  var userAgent = window.navigator.userAgent;\n  var platform = window.navigator.platform;\n  var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  var iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  var os = null;\n\n  if (macosPlatforms.indexOf(platform) !== -1) {\n    os = 'macOS';\n  } else if (iosPlatforms.indexOf(platform) !== -1) {\n    os = 'iOS';\n  } else if (windowsPlatforms.indexOf(platform) !== -1) {\n    os = 'Windows';\n  } else if (/Android/.test(userAgent)) {\n    os = 'Android';\n  } else if (/Linux/.test(platform)) {\n    os = 'Linux';\n  }\n\n  return os;\n}\n\nfunction getNodeOS() {\n  var os = platform() || 'linux';\n  var version = release() || '0.0.0';\n  var osMap = {\n    android: 'Android',\n    aix: 'Linux',\n    darwin: 'macOS',\n    freebsd: 'Linux',\n    linux: 'Linux',\n    openbsd: 'Linux',\n    sunos: 'Linux',\n    win32: 'Windows'\n  };\n\n  if (os in osMap) {\n    return \"\".concat(osMap[os] || 'Linux', \"/\").concat(version);\n  }\n\n  return null;\n}\n\nfunction getUserAgentHeader(sdk, application, integration, feature) {\n  var headerParts = [];\n\n  if (application) {\n    headerParts.push(\"app \".concat(application));\n  }\n\n  if (integration) {\n    headerParts.push(\"integration \".concat(integration));\n  }\n\n  if (feature) {\n    headerParts.push('feature ' + feature);\n  }\n\n  headerParts.push(\"sdk \".concat(sdk));\n  var os = null;\n\n  try {\n    if (isReactNative()) {\n      os = getBrowserOS();\n      headerParts.push('platform ReactNative');\n    } else if (isNode()) {\n      os = getNodeOS();\n      headerParts.push(\"platform node.js/\".concat(getNodeVersion()));\n    } else {\n      os = getBrowserOS();\n      headerParts.push(\"platform browser\");\n    }\n  } catch (e) {\n    os = null;\n  }\n\n  if (os) {\n    headerParts.push(\"os \".concat(os));\n  }\n\n  return \"\".concat(headerParts.filter(function (item) {\n    return item !== '';\n  }).join('; '), \";\");\n}\n/**\n * Mixes in a method to return just a plain object with no additional methods\n * @private\n * @param {Object} data - Any plain JSON response returned from the API\n * @return {Object} Enhanced object with toPlainObject method\n */\n\n\nfunction toPlainObject(data) {\n  return Object.defineProperty(data, 'toPlainObject', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function value() {\n      return cloneDeep(this);\n    }\n  });\n}\n\nexport { createHttpClient, createRequestConfig, enforceObjPath, freezeSys, getUserAgentHeader, toPlainObject };","map":{"version":3,"sources":["/Users/timothychoe/Desktop/Untitled-/node_modules/contentful-sdk-core/dist/index.es-modules.js"],"names":["cloneDeep","qs","isPlainObject","platform","release","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","Array","isArray","Symbol","iterator","_arr","_n","_d","_e","undefined","_i","_s","next","done","err","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","from","test","len","arr2","TypeError","attempts","networkErrorAttempts","rateLimit","instance","maxRetry","_instance$defaults","defaults","_instance$defaults$re","responseLogger","_instance$defaults$re2","requestLogger","interceptors","request","use","config","error","Promise","reject","response","retryOnError","retryErrorType","wait","Math","pow","SQRT2","status","concat","headers","requestId","delay","ms","resolve","setTimeout","floor","random","logHandler","httpAgent","httpsAgent","then","isNode","process","browser","getNodeVersion","versions","node","version","HOST_REGEX","createHttpClient","axios","options","defaultConfig","insecure","level","data","title","message","a","join","console","log","timeout","proxy","basePath","adapter","maxContentLength","accessToken","missingAccessTokenError","protocol","space","hostname","defaultHostname","port","host","parsed","split","_parsed","Boolean","baseURL","axiosOptions","paramsSerializer","stringify","create","httpClientParams","cloneWithNewParams","newParams","retryLimit","createRequestConfig","_ref","query","resolveLinks","params","enforceObjPath","path","Error","JSON","freezeObjectDeep","freeze","freezeSys","sys","isReactNative","window","navigator","product","getBrowserOS","userAgent","macosPlatforms","windowsPlatforms","iosPlatforms","os","indexOf","getNodeOS","osMap","android","aix","darwin","freebsd","linux","openbsd","sunos","win32","getUserAgentHeader","sdk","application","integration","feature","headerParts","e","item","toPlainObject"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,kBAAtB;AACA,OAAOC,EAAP,MAAe,IAAf;AACA,OAAOC,aAAP,MAA0B,sBAA1B;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,IAAlC;;AAEA,SAASC,eAAT,CAAyBC,GAAzB,EAA8BC,GAA9B,EAAmCC,KAAnC,EAA0C;AACxC,MAAID,GAAG,IAAID,GAAX,EAAgB;AACdG,IAAAA,MAAM,CAACC,cAAP,CAAsBJ,GAAtB,EAA2BC,GAA3B,EAAgC;AAC9BC,MAAAA,KAAK,EAAEA,KADuB;AAE9BG,MAAAA,UAAU,EAAE,IAFkB;AAG9BC,MAAAA,YAAY,EAAE,IAHgB;AAI9BC,MAAAA,QAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACLP,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAWC,KAAX;AACD;;AAED,SAAOF,GAAP;AACD;;AAED,SAASQ,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AACvC,MAAIC,IAAI,GAAGR,MAAM,CAACQ,IAAP,CAAYF,MAAZ,CAAX;;AAEA,MAAIN,MAAM,CAACS,qBAAX,EAAkC;AAChC,QAAIC,OAAO,GAAGV,MAAM,CAACS,qBAAP,CAA6BH,MAA7B,CAAd;AACA,QAAIC,cAAJ,EAAoBG,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe;AAC1D,aAAOZ,MAAM,CAACa,wBAAP,CAAgCP,MAAhC,EAAwCM,GAAxC,EAA6CV,UAApD;AACD,KAF6B,CAAV;AAGpBM,IAAAA,IAAI,CAACM,IAAL,CAAUC,KAAV,CAAgBP,IAAhB,EAAsBE,OAAtB;AACD;;AAED,SAAOF,IAAP;AACD;;AAED,SAASQ,cAAT,CAAwBC,MAAxB,EAAgC;AAC9B,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AACzC,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;;AAEA,QAAIA,CAAC,GAAG,CAAR,EAAW;AACTb,MAAAA,OAAO,CAACL,MAAM,CAACqB,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAUxB,GAAV,EAAe;AACnDF,QAAAA,eAAe,CAACqB,MAAD,EAASnB,GAAT,EAAcuB,MAAM,CAACvB,GAAD,CAApB,CAAf;AACD,OAFD;AAGD,KAJD,MAIO,IAAIE,MAAM,CAACuB,yBAAX,EAAsC;AAC3CvB,MAAAA,MAAM,CAACwB,gBAAP,CAAwBP,MAAxB,EAAgCjB,MAAM,CAACuB,yBAAP,CAAiCF,MAAjC,CAAhC;AACD,KAFM,MAEA;AACLhB,MAAAA,OAAO,CAACL,MAAM,CAACqB,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAUxB,GAAV,EAAe;AAC7CE,QAAAA,MAAM,CAACC,cAAP,CAAsBgB,MAAtB,EAA8BnB,GAA9B,EAAmCE,MAAM,CAACa,wBAAP,CAAgCQ,MAAhC,EAAwCvB,GAAxC,CAAnC;AACD,OAFD;AAGD;AACF;;AAED,SAAOmB,MAAP;AACD;;AAED,SAASQ,cAAT,CAAwBC,GAAxB,EAA6BR,CAA7B,EAAgC;AAC9B,SAAOS,eAAe,CAACD,GAAD,CAAf,IAAwBE,qBAAqB,CAACF,GAAD,EAAMR,CAAN,CAA7C,IAAyDW,2BAA2B,CAACH,GAAD,EAAMR,CAAN,CAApF,IAAgGY,gBAAgB,EAAvH;AACD;;AAED,SAASH,eAAT,CAAyBD,GAAzB,EAA8B;AAC5B,MAAIK,KAAK,CAACC,OAAN,CAAcN,GAAd,CAAJ,EAAwB,OAAOA,GAAP;AACzB;;AAED,SAASE,qBAAT,CAA+BF,GAA/B,EAAoCR,CAApC,EAAuC;AACrC,MAAI,OAAOe,MAAP,KAAkB,WAAlB,IAAiC,EAAEA,MAAM,CAACC,QAAP,IAAmBlC,MAAM,CAAC0B,GAAD,CAA3B,CAArC,EAAwE;AACxE,MAAIS,IAAI,GAAG,EAAX;AACA,MAAIC,EAAE,GAAG,IAAT;AACA,MAAIC,EAAE,GAAG,KAAT;AACA,MAAIC,EAAE,GAAGC,SAAT;;AAEA,MAAI;AACF,SAAK,IAAIC,EAAE,GAAGd,GAAG,CAACO,MAAM,CAACC,QAAR,CAAH,EAAT,EAAiCO,EAAtC,EAA0C,EAAEL,EAAE,GAAG,CAACK,EAAE,GAAGD,EAAE,CAACE,IAAH,EAAN,EAAiBC,IAAxB,CAA1C,EAAyEP,EAAE,GAAG,IAA9E,EAAoF;AAClFD,MAAAA,IAAI,CAACrB,IAAL,CAAU2B,EAAE,CAAC1C,KAAb;;AAEA,UAAImB,CAAC,IAAIiB,IAAI,CAACf,MAAL,KAAgBF,CAAzB,EAA4B;AAC7B;AACF,GAND,CAME,OAAO0B,GAAP,EAAY;AACZP,IAAAA,EAAE,GAAG,IAAL;AACAC,IAAAA,EAAE,GAAGM,GAAL;AACD,GATD,SASU;AACR,QAAI;AACF,UAAI,CAACR,EAAD,IAAOI,EAAE,CAAC,QAAD,CAAF,IAAgB,IAA3B,EAAiCA,EAAE,CAAC,QAAD,CAAF;AAClC,KAFD,SAEU;AACR,UAAIH,EAAJ,EAAQ,MAAMC,EAAN;AACT;AACF;;AAED,SAAOH,IAAP;AACD;;AAED,SAASN,2BAAT,CAAqCgB,CAArC,EAAwCC,MAAxC,EAAgD;AAC9C,MAAI,CAACD,CAAL,EAAQ;AACR,MAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B,OAAOE,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AAC3B,MAAIE,CAAC,GAAGhD,MAAM,CAACiD,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BN,CAA/B,EAAkCO,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;AACA,MAAIJ,CAAC,KAAK,QAAN,IAAkBH,CAAC,CAACQ,WAAxB,EAAqCL,CAAC,GAAGH,CAAC,CAACQ,WAAF,CAAcC,IAAlB;AACrC,MAAIN,CAAC,KAAK,KAAN,IAAeA,CAAC,KAAK,KAAzB,EAAgC,OAAOjB,KAAK,CAACwB,IAAN,CAAWP,CAAX,CAAP;AAChC,MAAIA,CAAC,KAAK,WAAN,IAAqB,2CAA2CQ,IAA3C,CAAgDR,CAAhD,CAAzB,EAA6E,OAAOD,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AAC9E;;AAED,SAASC,iBAAT,CAA2BrB,GAA3B,EAAgC+B,GAAhC,EAAqC;AACnC,MAAIA,GAAG,IAAI,IAAP,IAAeA,GAAG,GAAG/B,GAAG,CAACN,MAA7B,EAAqCqC,GAAG,GAAG/B,GAAG,CAACN,MAAV;;AAErC,OAAK,IAAIF,CAAC,GAAG,CAAR,EAAWwC,IAAI,GAAG,IAAI3B,KAAJ,CAAU0B,GAAV,CAAvB,EAAuCvC,CAAC,GAAGuC,GAA3C,EAAgDvC,CAAC,EAAjD;AAAqDwC,IAAAA,IAAI,CAACxC,CAAD,CAAJ,GAAUQ,GAAG,CAACR,CAAD,CAAb;AAArD;;AAEA,SAAOwC,IAAP;AACD;;AAED,SAAS5B,gBAAT,GAA4B;AAC1B,QAAM,IAAI6B,SAAJ,CAAc,2IAAd,CAAN;AACD;;AAED,IAAIC,QAAQ,GAAG,EAAf;AACA,IAAIC,oBAAoB,GAAG,CAA3B;;AACA,SAASC,SAAT,CAAmBC,QAAnB,EAA6B;AAC3B,MAAIC,QAAQ,GAAG7C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBoB,SAAzC,GAAqDpB,SAAS,CAAC,CAAD,CAA9D,GAAoE,CAAnF;AACA,MAAI8C,kBAAkB,GAAGF,QAAQ,CAACG,QAAlC;AAAA,MACIC,qBAAqB,GAAGF,kBAAkB,CAACG,cAD/C;AAAA,MAEIA,cAAc,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,YAAY;AAClE,WAAO5B,SAAP;AACD,GAFoB,GAEjB4B,qBAJJ;AAAA,MAKIE,sBAAsB,GAAGJ,kBAAkB,CAACK,aALhD;AAAA,MAMIA,aAAa,GAAGD,sBAAsB,KAAK,KAAK,CAAhC,GAAoC,YAAY;AAClE,WAAO9B,SAAP;AACD,GAFmB,GAEhB8B,sBARJ;AASAN,EAAAA,QAAQ,CAACQ,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAAkC,UAAUC,MAAV,EAAkB;AAClDJ,IAAAA,aAAa,CAACI,MAAD,CAAb;AACA,WAAOA,MAAP;AACD,GAHD,EAGG,UAAUC,KAAV,EAAiB;AAClB,WAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,GALD;AAMAZ,EAAAA,QAAQ,CAACQ,YAAT,CAAsBO,QAAtB,CAA+BL,GAA/B,CAAmC,UAAUK,QAAV,EAAoB;AACrD;AACAV,IAAAA,cAAc,CAACU,QAAD,CAAd;AACA,WAAOA,QAAP;AACD,GAJD,EAIG,UAAUH,KAAV,EAAiB;AAClB,QAAIG,QAAQ,GAAGH,KAAK,CAACG,QAArB;AAAA,QACIJ,MAAM,GAAGC,KAAK,CAACD,MADnB,CADkB,CAES;;AAE3B,QAAI,CAACA,MAAD,IAAW,CAACX,QAAQ,CAACG,QAAT,CAAkBa,YAAlC,EAAgD;AAC9C,aAAOH,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD;;AAED,QAAIK,cAAc,GAAG,IAArB;AACA,QAAIC,IAAI,GAAG,CAAX,CATkB,CASJ;;AAEd,QAAI,CAACH,QAAL,EAAe;AACbE,MAAAA,cAAc,GAAG,YAAjB;AACAnB,MAAAA,oBAAoB;;AAEpB,UAAIA,oBAAoB,GAAGG,QAA3B,EAAqC;AACnCW,QAAAA,KAAK,CAACf,QAAN,GAAiBC,oBAAjB;AACA,eAAOe,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD;;AAEDM,MAAAA,IAAI,GAAGC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,KAAd,EAAqBvB,oBAArB,CAAP;AACAiB,MAAAA,QAAQ,GAAG,EAAX;AACD,KAXD,MAWO;AACLjB,MAAAA,oBAAoB,GAAG,CAAvB;AACD;;AAED,QAAIiB,QAAQ,CAACO,MAAT,IAAmB,GAAnB,IAA0BP,QAAQ,CAACO,MAAT,GAAkB,GAAhD,EAAqD;AACnD;AACAL,MAAAA,cAAc,GAAG,UAAUM,MAAV,CAAiBR,QAAQ,CAACO,MAA1B,CAAjB;AACA,UAAIE,OAAO,GAAGT,QAAQ,CAACS,OAAT,IAAoB,EAAlC;AACA,UAAIC,SAAS,GAAGD,OAAO,CAAC,yBAAD,CAAP,IAAsC,IAAtD;AACA3B,MAAAA,QAAQ,CAAC4B,SAAD,CAAR,GAAsB5B,QAAQ,CAAC4B,SAAD,CAAR,IAAuB,CAA7C;AACA5B,MAAAA,QAAQ,CAAC4B,SAAD,CAAR,GANmD,CAM5B;;AAEvB,UAAI5B,QAAQ,CAAC4B,SAAD,CAAR,GAAsBxB,QAAtB,IAAkC,CAACwB,SAAvC,EAAkD;AAChDb,QAAAA,KAAK,CAACf,QAAN,GAAiBA,QAAQ,CAAC4B,SAAD,CAAzB;AACA,eAAOZ,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD;;AAEDM,MAAAA,IAAI,GAAGC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,KAAd,EAAqBxB,QAAQ,CAAC4B,SAAD,CAA7B,CAAP;AACD,KAdD,MAcO,IAAIV,QAAQ,CAACO,MAAT,KAAoB,GAAxB,EAA6B;AAClC;AACAL,MAAAA,cAAc,GAAG,YAAjB,CAFkC,CAEH;;AAE/B,UAAIF,QAAQ,CAACS,OAAT,IAAoBZ,KAAK,CAACG,QAAN,CAAeS,OAAf,CAAuB,8BAAvB,CAAxB,EAAgF;AAC9EN,QAAAA,IAAI,GAAGH,QAAQ,CAACS,OAAT,CAAiB,8BAAjB,CAAP;AACD;AACF;;AAED,QAAIE,KAAK,GAAG,SAASA,KAAT,CAAeC,EAAf,EAAmB;AAC7B,aAAO,IAAId,OAAJ,CAAY,UAAUe,OAAV,EAAmB;AACpCC,QAAAA,UAAU,CAACD,OAAD,EAAUD,EAAV,CAAV;AACD,OAFM,CAAP;AAGD,KAJD;;AAMA,QAAIV,cAAJ,EAAoB;AAClB;AACAC,MAAAA,IAAI,GAAGC,IAAI,CAACW,KAAL,CAAWZ,IAAI,GAAG,IAAP,GAAcC,IAAI,CAACY,MAAL,KAAgB,GAA9B,GAAoC,GAA/C,CAAP;AACA/B,MAAAA,QAAQ,CAACG,QAAT,CAAkB6B,UAAlB,CAA6B,SAA7B,EAAwC,GAAGT,MAAH,CAAUN,cAAV,EAA0B,+BAA1B,EAA2DM,MAA3D,CAAkEL,IAAlE,EAAwE,wBAAxE,CAAxC;AACA;;;;AAIA,aAAOP,MAAM,CAACsB,SAAd;AACA,aAAOtB,MAAM,CAACuB,UAAd;AACA,aAAOR,KAAK,CAACR,IAAD,CAAL,CAAYiB,IAAZ,CAAiB,YAAY;AAClC,eAAOnC,QAAQ,CAACW,MAAD,CAAf;AACD,OAFM,CAAP;AAGD;;AAED,WAAOE,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,GA3ED;AA4ED;;AAED,SAASwB,MAAT,GAAkB;AAChB;;;;;;;AAOA,SAAO,OAAOC,OAAP,KAAmB,WAAnB,IAAkC,CAACA,OAAO,CAACC,OAAlD;AACD;;AACD,SAASC,cAAT,GAA0B;AACxB,SAAOF,OAAO,CAACG,QAAR,IAAoBH,OAAO,CAACG,QAAR,CAAiBC,IAArC,GAA4C,IAAIlB,MAAJ,CAAWc,OAAO,CAACG,QAAR,CAAiBC,IAA5B,CAA5C,GAAgFJ,OAAO,CAACK,OAA/F;AACD,C,CAED;;;AAEA,IAAIC,UAAU,GAAG,mDAAjB;AACA;;;;;;;;;;;;;;;;;;;;AAoBA,SAASC,gBAAT,CAA0BC,KAA1B,EAAiCC,OAAjC,EAA0C;AACxC,MAAIC,aAAa,GAAG;AAClBC,IAAAA,QAAQ,EAAE,KADQ;AAElBhC,IAAAA,YAAY,EAAE,IAFI;AAGlBgB,IAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBiB,KAApB,EAA2BC,IAA3B,EAAiC;AAC3C,UAAID,KAAK,KAAK,OAAV,IAAqBC,IAAzB,EAA+B;AAC7B,YAAIC,KAAK,GAAG,CAACD,IAAI,CAAC3D,IAAN,EAAY2D,IAAI,CAACE,OAAjB,EAA0BxG,MAA1B,CAAiC,UAAUyG,CAAV,EAAa;AACxD,iBAAOA,CAAP;AACD,SAFW,EAETC,IAFS,CAEJ,KAFI,CAAZ;AAGAC,QAAAA,OAAO,CAAC3C,KAAR,CAAc,WAAWW,MAAX,CAAkB4B,KAAlB,CAAd;AACAI,QAAAA,OAAO,CAAC3C,KAAR,CAAcsC,IAAd;AACA;AACD;;AAEDK,MAAAA,OAAO,CAACC,GAAR,CAAY,IAAIjC,MAAJ,CAAW0B,KAAX,EAAkB,IAAlB,EAAwB1B,MAAxB,CAA+B2B,IAA/B,CAAZ;AACD,KAdiB;AAelB;AACA1B,IAAAA,OAAO,EAAE,EAhBS;AAiBlBS,IAAAA,SAAS,EAAE,KAjBO;AAkBlBC,IAAAA,UAAU,EAAE,KAlBM;AAmBlBuB,IAAAA,OAAO,EAAE,KAnBS;AAoBlBC,IAAAA,KAAK,EAAE,KApBW;AAqBlBC,IAAAA,QAAQ,EAAE,EArBQ;AAsBlBC,IAAAA,OAAO,EAAE,KAtBS;AAuBlBC,IAAAA,gBAAgB,EAAE,UAvBA,CAuBW;;AAvBX,GAApB;;AA2BA,MAAIlD,MAAM,GAAG1D,cAAc,CAAC,EAAD,EAAK8F,aAAL,EAAoB,EAApB,EAAwBD,OAAxB,CAA3B;;AAEA,MAAI,CAACnC,MAAM,CAACmD,WAAZ,EAAyB;AACvB,QAAIC,uBAAuB,GAAG,IAAInE,SAAJ,CAAc,gCAAd,CAA9B;AACAe,IAAAA,MAAM,CAACqB,UAAP,CAAkB,OAAlB,EAA2B+B,uBAA3B;AACA,UAAMA,uBAAN;AACD,GAlCuC,CAkCtC;;;AAGF,MAAIC,QAAQ,GAAGrD,MAAM,CAACqC,QAAP,GAAkB,MAAlB,GAA2B,OAA1C;AACA,MAAIiB,KAAK,GAAGtD,MAAM,CAACsD,KAAP,GAAe,GAAG1C,MAAH,CAAUZ,MAAM,CAACsD,KAAjB,EAAwB,GAAxB,CAAf,GAA8C,EAA1D;AACA,MAAIC,QAAQ,GAAGvD,MAAM,CAACwD,eAAtB;AACA,MAAIC,IAAI,GAAGzD,MAAM,CAACqC,QAAP,GAAkB,EAAlB,GAAuB,GAAlC;;AAEA,MAAIrC,MAAM,CAAC0D,IAAP,IAAe1B,UAAU,CAAClD,IAAX,CAAgBkB,MAAM,CAAC0D,IAAvB,CAAnB,EAAiD;AAC/C,QAAIC,MAAM,GAAG3D,MAAM,CAAC0D,IAAP,CAAYE,KAAZ,CAAkB,GAAlB,CAAb;;AAEA,QAAID,MAAM,CAACjH,MAAP,KAAkB,CAAtB,EAAyB;AACvB,UAAImH,OAAO,GAAG9G,cAAc,CAAC4G,MAAD,EAAS,CAAT,CAA5B;;AAEAJ,MAAAA,QAAQ,GAAGM,OAAO,CAAC,CAAD,CAAlB;AACAJ,MAAAA,IAAI,GAAGI,OAAO,CAAC,CAAD,CAAd;AACD,KALD,MAKO;AACLN,MAAAA,QAAQ,GAAGI,MAAM,CAAC,CAAD,CAAjB;AACD;AACF,GArDuC,CAqDtC;;;AAGF,MAAI3D,MAAM,CAACgD,QAAX,EAAqB;AACnBhD,IAAAA,MAAM,CAACgD,QAAP,GAAkB,IAAIpC,MAAJ,CAAWZ,MAAM,CAACgD,QAAP,CAAgBY,KAAhB,CAAsB,GAAtB,EAA2B3H,MAA3B,CAAkC6H,OAAlC,EAA2CnB,IAA3C,CAAgD,GAAhD,CAAX,CAAlB;AACD;;AAED,MAAIoB,OAAO,GAAG5B,OAAO,CAAC4B,OAAR,IAAmB,GAAGnD,MAAH,CAAUyC,QAAV,EAAoB,KAApB,EAA2BzC,MAA3B,CAAkC2C,QAAlC,EAA4C,GAA5C,EAAiD3C,MAAjD,CAAwD6C,IAAxD,EAA8D7C,MAA9D,CAAqEZ,MAAM,CAACgD,QAA5E,EAAsF,UAAtF,EAAkGpC,MAAlG,CAAyG0C,KAAzG,CAAjC;;AAEA,MAAI,CAACtD,MAAM,CAACa,OAAP,CAAe,eAAf,CAAL,EAAsC;AACpCb,IAAAA,MAAM,CAACa,OAAP,CAAe,eAAf,IAAkC,YAAYb,MAAM,CAACmD,WAArD;AACD,GAhEuC,CAgEtC;AACF;AACA;;;AAGA,MAAI1B,MAAM,EAAV,EAAc;AACZzB,IAAAA,MAAM,CAACa,OAAP,CAAe,YAAf,IAA+B,aAAae,cAAc,EAA1D;AACA5B,IAAAA,MAAM,CAACa,OAAP,CAAe,iBAAf,IAAoC,MAApC;AACD;;AAED,MAAImD,YAAY,GAAG;AACjB;AACAD,IAAAA,OAAO,EAAEA,OAFQ;AAGjBlD,IAAAA,OAAO,EAAEb,MAAM,CAACa,OAHC;AAIjBS,IAAAA,SAAS,EAAEtB,MAAM,CAACsB,SAJD;AAKjBC,IAAAA,UAAU,EAAEvB,MAAM,CAACuB,UALF;AAMjB0C,IAAAA,gBAAgB,EAAEnJ,EAAE,CAACoJ,SANJ;AAOjBnB,IAAAA,KAAK,EAAE/C,MAAM,CAAC+C,KAPG;AAQjBD,IAAAA,OAAO,EAAE9C,MAAM,CAAC8C,OARC;AASjBG,IAAAA,OAAO,EAAEjD,MAAM,CAACiD,OATC;AAUjBC,IAAAA,gBAAgB,EAAElD,MAAM,CAACkD,gBAVR;AAWjB;AACA7B,IAAAA,UAAU,EAAErB,MAAM,CAACqB,UAZF;AAajB3B,IAAAA,cAAc,EAAEM,MAAM,CAACN,cAbN;AAcjBE,IAAAA,aAAa,EAAEI,MAAM,CAACJ,aAdL;AAejBS,IAAAA,YAAY,EAAEL,MAAM,CAACK;AAfJ,GAAnB;AAiBA,MAAIhB,QAAQ,GAAG6C,KAAK,CAACiC,MAAN,CAAaH,YAAb,CAAf;AACA3E,EAAAA,QAAQ,CAAC+E,gBAAT,GAA4BjC,OAA5B;AACA;;;;;;;;;;;AAWA9C,EAAAA,QAAQ,CAACgF,kBAAT,GAA8B,UAAUC,SAAV,EAAqB;AACjD,WAAOrC,gBAAgB,CAACC,KAAD,EAAQ5F,cAAc,CAAC,EAAD,EAAKzB,SAAS,CAACsH,OAAD,CAAd,EAAyB,EAAzB,EAA6BmC,SAA7B,CAAtB,CAAvB;AACD,GAFD;;AAIAlF,EAAAA,SAAS,CAACC,QAAD,EAAWW,MAAM,CAACuE,UAAlB,CAAT;AACA,SAAOlF,QAAP;AACD;AAED;;;;;;;;AAOA,SAASmF,mBAAT,CAA6BC,IAA7B,EAAmC;AACjC,MAAIC,KAAK,GAAGD,IAAI,CAACC,KAAjB;AACA,MAAI1E,MAAM,GAAG,EAAb;AACA,SAAO0E,KAAK,CAACC,YAAb;AACA3E,EAAAA,MAAM,CAAC4E,MAAP,GAAgB/J,SAAS,CAAC6J,KAAD,CAAzB;AACA,SAAO1E,MAAP;AACD;;AAED,SAAS6E,cAAT,CAAwB1J,GAAxB,EAA6B2J,IAA7B,EAAmC;AACjC,MAAI,EAAEA,IAAI,IAAI3J,GAAV,CAAJ,EAAoB;AAClB,QAAI+C,GAAG,GAAG,IAAI6G,KAAJ,EAAV;AACA7G,IAAAA,GAAG,CAACU,IAAJ,GAAW,iBAAX;AACAV,IAAAA,GAAG,CAACuE,OAAJ,GAAc,qBAAqB7B,MAArB,CAA4BkE,IAA5B,EAAkC,oBAAlC,EAAwDlE,MAAxD,CAA+DoE,IAAI,CAACd,SAAL,CAAe/I,GAAf,CAA/D,EAAoF,MAApF,CAAd;AACA,UAAM+C,GAAN;AACD;;AAED,SAAO,IAAP;AACD;;AAED,SAAS+G,gBAAT,CAA0B9J,GAA1B,EAA+B;AAC7BG,EAAAA,MAAM,CAACQ,IAAP,CAAYX,GAAZ,EAAiByB,OAAjB,CAAyB,UAAUxB,GAAV,EAAe;AACtC,QAAIC,KAAK,GAAGF,GAAG,CAACC,GAAD,CAAf;;AAEA,QAAIL,aAAa,CAACM,KAAD,CAAjB,EAA0B;AACxB4J,MAAAA,gBAAgB,CAAC5J,KAAD,CAAhB;AACD;AACF,GAND;AAOA,SAAOC,MAAM,CAAC4J,MAAP,CAAc/J,GAAd,CAAP;AACD;;AAED,SAASgK,SAAT,CAAmBhK,GAAnB,EAAwB;AACtB8J,EAAAA,gBAAgB,CAAC9J,GAAG,CAACiK,GAAJ,IAAW,EAAZ,CAAhB;AACA,SAAOjK,GAAP;AACD;;AAED,SAASkK,aAAT,GAAyB;AACvB,SAAO,OAAOC,MAAP,KAAkB,WAAlB,IAAiC,eAAeA,MAAhD,IAA0D,aAAaA,MAAM,CAACC,SAA9E,IAA2FD,MAAM,CAACC,SAAP,CAAiBC,OAAjB,KAA6B,aAA/H;AACD;;AAED,SAASC,YAAT,GAAwB;AACtB,MAAI,CAACH,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AAED,MAAII,SAAS,GAAGJ,MAAM,CAACC,SAAP,CAAiBG,SAAjC;AACA,MAAI1K,QAAQ,GAAGsK,MAAM,CAACC,SAAP,CAAiBvK,QAAhC;AACA,MAAI2K,cAAc,GAAG,CAAC,WAAD,EAAc,UAAd,EAA0B,QAA1B,EAAoC,QAApC,CAArB;AACA,MAAIC,gBAAgB,GAAG,CAAC,OAAD,EAAU,OAAV,EAAmB,SAAnB,EAA8B,OAA9B,CAAvB;AACA,MAAIC,YAAY,GAAG,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB,CAAnB;AACA,MAAIC,EAAE,GAAG,IAAT;;AAEA,MAAIH,cAAc,CAACI,OAAf,CAAuB/K,QAAvB,MAAqC,CAAC,CAA1C,EAA6C;AAC3C8K,IAAAA,EAAE,GAAG,OAAL;AACD,GAFD,MAEO,IAAID,YAAY,CAACE,OAAb,CAAqB/K,QAArB,MAAmC,CAAC,CAAxC,EAA2C;AAChD8K,IAAAA,EAAE,GAAG,KAAL;AACD,GAFM,MAEA,IAAIF,gBAAgB,CAACG,OAAjB,CAAyB/K,QAAzB,MAAuC,CAAC,CAA5C,EAA+C;AACpD8K,IAAAA,EAAE,GAAG,SAAL;AACD,GAFM,MAEA,IAAI,UAAUhH,IAAV,CAAe4G,SAAf,CAAJ,EAA+B;AACpCI,IAAAA,EAAE,GAAG,SAAL;AACD,GAFM,MAEA,IAAI,QAAQhH,IAAR,CAAa9D,QAAb,CAAJ,EAA4B;AACjC8K,IAAAA,EAAE,GAAG,OAAL;AACD;;AAED,SAAOA,EAAP;AACD;;AAED,SAASE,SAAT,GAAqB;AACnB,MAAIF,EAAE,GAAG9K,QAAQ,MAAM,OAAvB;AACA,MAAI+G,OAAO,GAAG9G,OAAO,MAAM,OAA3B;AACA,MAAIgL,KAAK,GAAG;AACVC,IAAAA,OAAO,EAAE,SADC;AAEVC,IAAAA,GAAG,EAAE,OAFK;AAGVC,IAAAA,MAAM,EAAE,OAHE;AAIVC,IAAAA,OAAO,EAAE,OAJC;AAKVC,IAAAA,KAAK,EAAE,OALG;AAMVC,IAAAA,OAAO,EAAE,OANC;AAOVC,IAAAA,KAAK,EAAE,OAPG;AAQVC,IAAAA,KAAK,EAAE;AARG,GAAZ;;AAWA,MAAIX,EAAE,IAAIG,KAAV,EAAiB;AACf,WAAO,GAAGrF,MAAH,CAAUqF,KAAK,CAACH,EAAD,CAAL,IAAa,OAAvB,EAAgC,GAAhC,EAAqClF,MAArC,CAA4CmB,OAA5C,CAAP;AACD;;AAED,SAAO,IAAP;AACD;;AAED,SAAS2E,kBAAT,CAA4BC,GAA5B,EAAiCC,WAAjC,EAA8CC,WAA9C,EAA2DC,OAA3D,EAAoE;AAClE,MAAIC,WAAW,GAAG,EAAlB;;AAEA,MAAIH,WAAJ,EAAiB;AACfG,IAAAA,WAAW,CAAC3K,IAAZ,CAAiB,OAAOwE,MAAP,CAAcgG,WAAd,CAAjB;AACD;;AAED,MAAIC,WAAJ,EAAiB;AACfE,IAAAA,WAAW,CAAC3K,IAAZ,CAAiB,eAAewE,MAAf,CAAsBiG,WAAtB,CAAjB;AACD;;AAED,MAAIC,OAAJ,EAAa;AACXC,IAAAA,WAAW,CAAC3K,IAAZ,CAAiB,aAAa0K,OAA9B;AACD;;AAEDC,EAAAA,WAAW,CAAC3K,IAAZ,CAAiB,OAAOwE,MAAP,CAAc+F,GAAd,CAAjB;AACA,MAAIb,EAAE,GAAG,IAAT;;AAEA,MAAI;AACF,QAAIT,aAAa,EAAjB,EAAqB;AACnBS,MAAAA,EAAE,GAAGL,YAAY,EAAjB;AACAsB,MAAAA,WAAW,CAAC3K,IAAZ,CAAiB,sBAAjB;AACD,KAHD,MAGO,IAAIqF,MAAM,EAAV,EAAc;AACnBqE,MAAAA,EAAE,GAAGE,SAAS,EAAd;AACAe,MAAAA,WAAW,CAAC3K,IAAZ,CAAiB,oBAAoBwE,MAApB,CAA2BgB,cAAc,EAAzC,CAAjB;AACD,KAHM,MAGA;AACLkE,MAAAA,EAAE,GAAGL,YAAY,EAAjB;AACAsB,MAAAA,WAAW,CAAC3K,IAAZ,CAAiB,kBAAjB;AACD;AACF,GAXD,CAWE,OAAO4K,CAAP,EAAU;AACVlB,IAAAA,EAAE,GAAG,IAAL;AACD;;AAED,MAAIA,EAAJ,EAAQ;AACNiB,IAAAA,WAAW,CAAC3K,IAAZ,CAAiB,MAAMwE,MAAN,CAAakF,EAAb,CAAjB;AACD;;AAED,SAAO,GAAGlF,MAAH,CAAUmG,WAAW,CAAC9K,MAAZ,CAAmB,UAAUgL,IAAV,EAAgB;AAClD,WAAOA,IAAI,KAAK,EAAhB;AACD,GAFgB,EAEdtE,IAFc,CAET,IAFS,CAAV,EAEQ,GAFR,CAAP;AAGD;AAED;;;;;;;;AAOA,SAASuE,aAAT,CAAuB3E,IAAvB,EAA6B;AAC3B,SAAOjH,MAAM,CAACC,cAAP,CAAsBgH,IAAtB,EAA4B,eAA5B,EAA6C;AAClD/G,IAAAA,UAAU,EAAE,KADsC;AAElDC,IAAAA,YAAY,EAAE,KAFoC;AAGlDC,IAAAA,QAAQ,EAAE,KAHwC;AAIlDL,IAAAA,KAAK,EAAE,SAASA,KAAT,GAAiB;AACtB,aAAOR,SAAS,CAAC,IAAD,CAAhB;AACD;AANiD,GAA7C,CAAP;AAQD;;AAED,SAASoH,gBAAT,EAA2BuC,mBAA3B,EAAgDK,cAAhD,EAAgEM,SAAhE,EAA2EuB,kBAA3E,EAA+FQ,aAA/F","sourcesContent":["import cloneDeep from 'lodash/cloneDeep';\nimport qs from 'qs';\nimport isPlainObject from 'lodash/isPlainObject';\nimport { platform, release } from 'os';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar attempts = {};\nvar networkErrorAttempts = 0;\nfunction rateLimit(instance) {\n  var maxRetry = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  var _instance$defaults = instance.defaults,\n      _instance$defaults$re = _instance$defaults.responseLogger,\n      responseLogger = _instance$defaults$re === void 0 ? function () {\n    return undefined;\n  } : _instance$defaults$re,\n      _instance$defaults$re2 = _instance$defaults.requestLogger,\n      requestLogger = _instance$defaults$re2 === void 0 ? function () {\n    return undefined;\n  } : _instance$defaults$re2;\n  instance.interceptors.request.use(function (config) {\n    requestLogger(config);\n    return config;\n  }, function (error) {\n    return Promise.reject(error);\n  });\n  instance.interceptors.response.use(function (response) {\n    // we don't need to do anything here\n    responseLogger(response);\n    return response;\n  }, function (error) {\n    var response = error.response,\n        config = error.config; // Do not retry if it is disabled or no request config exists (not an axios error)\n\n    if (!config || !instance.defaults.retryOnError) {\n      return Promise.reject(error);\n    }\n\n    var retryErrorType = null;\n    var wait = 0; // Errors without response did not recieve anything from the server\n\n    if (!response) {\n      retryErrorType = 'Connection';\n      networkErrorAttempts++;\n\n      if (networkErrorAttempts > maxRetry) {\n        error.attempts = networkErrorAttempts;\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, networkErrorAttempts);\n      response = {};\n    } else {\n      networkErrorAttempts = 0;\n    }\n\n    if (response.status >= 500 && response.status < 600) {\n      // 5** errors are server related\n      retryErrorType = \"Server \".concat(response.status);\n      var headers = response.headers || {};\n      var requestId = headers['x-contentful-request-id'] || null;\n      attempts[requestId] = attempts[requestId] || 0;\n      attempts[requestId]++; // we reject if there are too many errors with the same request id or request id is not defined\n\n      if (attempts[requestId] > maxRetry || !requestId) {\n        error.attempts = attempts[requestId];\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, attempts[requestId]);\n    } else if (response.status === 429) {\n      // 429 errors are exceeded rate limit exceptions\n      retryErrorType = 'Rate limit'; // all headers are lowercased by axios https://github.com/mzabriskie/axios/issues/413\n\n      if (response.headers && error.response.headers['x-contentful-ratelimit-reset']) {\n        wait = response.headers['x-contentful-ratelimit-reset'];\n      }\n    }\n\n    var delay = function delay(ms) {\n      return new Promise(function (resolve) {\n        setTimeout(resolve, ms);\n      });\n    };\n\n    if (retryErrorType) {\n      // convert to ms and add jitter\n      wait = Math.floor(wait * 1000 + Math.random() * 200 + 500);\n      instance.defaults.logHandler('warning', \"\".concat(retryErrorType, \" error occurred. Waiting for \").concat(wait, \" ms before retrying...\"));\n      /* Somehow between the interceptor and retrying the request the httpAgent/httpsAgent gets transformed from an Agent-like object\n         to a regular object, causing failures on retries after rate limits. Removing these properties here fixes the error, but retry\n         requests still use the original http/httpsAgent property */\n\n      delete config.httpAgent;\n      delete config.httpsAgent;\n      return delay(wait).then(function () {\n        return instance(config);\n      });\n    }\n\n    return Promise.reject(error);\n  });\n}\n\nfunction isNode() {\n  /**\n   * Polyfills of 'process' might set process.browser === true\n   *\n   * See:\n   * https://github.com/webpack/node-libs-browser/blob/master/mock/process.js#L8\n   * https://github.com/defunctzombie/node-process/blob/master/browser.js#L156\n  **/\n  return typeof process !== 'undefined' && !process.browser;\n}\nfunction getNodeVersion() {\n  return process.versions && process.versions.node ? \"v\".concat(process.versions.node) : process.version;\n}\n\n// Also enforces toplevel domain specified, no spaces and no protocol\n\nvar HOST_REGEX = /^(?!\\w+:\\/\\/)([^\\s:]+\\.?[^\\s:]+)(?::(\\d+))?(?!:)$/;\n/**\n * Create pre configured axios instance\n * @private\n * @param {Object} axios - Axios library\n * @param {Object} httpClientParams - Initialization parameters for the HTTP client\n * @prop {string} space - Space ID\n * @prop {string} accessToken - Access Token\n * @prop {boolean=} insecure - If we should use http instead\n * @prop {string=} host - Alternate host\n * @prop {Object=} httpAgent - HTTP agent for node\n * @prop {Object=} httpsAgent - HTTPS agent for node\n * @prop {function=} adapter - Axios adapter to handle requests\n * @prop {function=} requestLogger - Gets called on every request triggered by the SDK, takes the axios request config as an argument\n * @prop {function=} responseLogger - Gets called on every response, takes axios response object as an argument\n * @prop {Object=} proxy - Axios proxy config\n * @prop {Object=} headers - Additional headers\n * @prop {function=} logHandler - A log handler function to process given log messages & errors. Receives the log level (error, warning & info) and the actual log data (Error object or string). (Default can be found here: https://github.com/contentful/contentful-sdk-core/blob/master/lib/create-http-client.js)\n * @return {Object} Initialized axios instance\n */\n\nfunction createHttpClient(axios, options) {\n  var defaultConfig = {\n    insecure: false,\n    retryOnError: true,\n    logHandler: function logHandler(level, data) {\n      if (level === 'error' && data) {\n        var title = [data.name, data.message].filter(function (a) {\n          return a;\n        }).join(' - ');\n        console.error(\"[error] \".concat(title));\n        console.error(data);\n        return;\n      }\n\n      console.log(\"[\".concat(level, \"] \").concat(data));\n    },\n    // Passed to axios\n    headers: {},\n    httpAgent: false,\n    httpsAgent: false,\n    timeout: 30000,\n    proxy: false,\n    basePath: '',\n    adapter: false,\n    maxContentLength: 1073741824 // 1GB\n\n  };\n\n  var config = _objectSpread2({}, defaultConfig, {}, options);\n\n  if (!config.accessToken) {\n    var missingAccessTokenError = new TypeError('Expected parameter accessToken');\n    config.logHandler('error', missingAccessTokenError);\n    throw missingAccessTokenError;\n  } // Construct axios baseURL option\n\n\n  var protocol = config.insecure ? 'http' : 'https';\n  var space = config.space ? \"\".concat(config.space, \"/\") : '';\n  var hostname = config.defaultHostname;\n  var port = config.insecure ? 80 : 443;\n\n  if (config.host && HOST_REGEX.test(config.host)) {\n    var parsed = config.host.split(':');\n\n    if (parsed.length === 2) {\n      var _parsed = _slicedToArray(parsed, 2);\n\n      hostname = _parsed[0];\n      port = _parsed[1];\n    } else {\n      hostname = parsed[0];\n    }\n  } // Ensure that basePath does start but not end with a slash\n\n\n  if (config.basePath) {\n    config.basePath = \"/\".concat(config.basePath.split('/').filter(Boolean).join('/'));\n  }\n\n  var baseURL = options.baseURL || \"\".concat(protocol, \"://\").concat(hostname, \":\").concat(port).concat(config.basePath, \"/spaces/\").concat(space);\n\n  if (!config.headers['Authorization']) {\n    config.headers['Authorization'] = 'Bearer ' + config.accessToken;\n  } // Set these headers only for node because browsers don't like it when you\n  // override user-agent or accept-encoding.\n  // The SDKs should set their own X-Contentful-User-Agent.\n\n\n  if (isNode()) {\n    config.headers['user-agent'] = 'node.js/' + getNodeVersion();\n    config.headers['Accept-Encoding'] = 'gzip';\n  }\n\n  var axiosOptions = {\n    // Axios\n    baseURL: baseURL,\n    headers: config.headers,\n    httpAgent: config.httpAgent,\n    httpsAgent: config.httpsAgent,\n    paramsSerializer: qs.stringify,\n    proxy: config.proxy,\n    timeout: config.timeout,\n    adapter: config.adapter,\n    maxContentLength: config.maxContentLength,\n    // Contentful\n    logHandler: config.logHandler,\n    responseLogger: config.responseLogger,\n    requestLogger: config.requestLogger,\n    retryOnError: config.retryOnError\n  };\n  var instance = axios.create(axiosOptions);\n  instance.httpClientParams = options;\n  /**\n   * Creates a new axios instance with the same default base parameters as the\n   * current one, and with any overrides passed to the newParams object\n   * This is useful as the SDKs use dependency injection to get the axios library\n   * and the version of the library comes from different places depending\n   * on whether it's a browser build or a node.js build.\n   * @private\n   * @param {Object} httpClientParams - Initialization parameters for the HTTP client\n   * @return {Object} Initialized axios instance\n   */\n\n  instance.cloneWithNewParams = function (newParams) {\n    return createHttpClient(axios, _objectSpread2({}, cloneDeep(options), {}, newParams));\n  };\n\n  rateLimit(instance, config.retryLimit);\n  return instance;\n}\n\n/**\n * Creates request parameters configuration by parsing an existing query object\n * @private\n * @param {Object} query\n * @return {Object} Config object with `params` property, ready to be used in axios\n */\n\nfunction createRequestConfig(_ref) {\n  var query = _ref.query;\n  var config = {};\n  delete query.resolveLinks;\n  config.params = cloneDeep(query);\n  return config;\n}\n\nfunction enforceObjPath(obj, path) {\n  if (!(path in obj)) {\n    var err = new Error();\n    err.name = 'PropertyMissing';\n    err.message = \"Required property \".concat(path, \" missing from:\\n\\n\").concat(JSON.stringify(obj), \"\\n\\n\");\n    throw err;\n  }\n\n  return true;\n}\n\nfunction freezeObjectDeep(obj) {\n  Object.keys(obj).forEach(function (key) {\n    var value = obj[key];\n\n    if (isPlainObject(value)) {\n      freezeObjectDeep(value);\n    }\n  });\n  return Object.freeze(obj);\n}\n\nfunction freezeSys(obj) {\n  freezeObjectDeep(obj.sys || {});\n  return obj;\n}\n\nfunction isReactNative() {\n  return typeof window !== 'undefined' && 'navigator' in window && 'product' in window.navigator && window.navigator.product === 'ReactNative';\n}\n\nfunction getBrowserOS() {\n  if (!window) {\n    return null;\n  }\n\n  var userAgent = window.navigator.userAgent;\n  var platform = window.navigator.platform;\n  var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  var iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  var os = null;\n\n  if (macosPlatforms.indexOf(platform) !== -1) {\n    os = 'macOS';\n  } else if (iosPlatforms.indexOf(platform) !== -1) {\n    os = 'iOS';\n  } else if (windowsPlatforms.indexOf(platform) !== -1) {\n    os = 'Windows';\n  } else if (/Android/.test(userAgent)) {\n    os = 'Android';\n  } else if (/Linux/.test(platform)) {\n    os = 'Linux';\n  }\n\n  return os;\n}\n\nfunction getNodeOS() {\n  var os = platform() || 'linux';\n  var version = release() || '0.0.0';\n  var osMap = {\n    android: 'Android',\n    aix: 'Linux',\n    darwin: 'macOS',\n    freebsd: 'Linux',\n    linux: 'Linux',\n    openbsd: 'Linux',\n    sunos: 'Linux',\n    win32: 'Windows'\n  };\n\n  if (os in osMap) {\n    return \"\".concat(osMap[os] || 'Linux', \"/\").concat(version);\n  }\n\n  return null;\n}\n\nfunction getUserAgentHeader(sdk, application, integration, feature) {\n  var headerParts = [];\n\n  if (application) {\n    headerParts.push(\"app \".concat(application));\n  }\n\n  if (integration) {\n    headerParts.push(\"integration \".concat(integration));\n  }\n\n  if (feature) {\n    headerParts.push('feature ' + feature);\n  }\n\n  headerParts.push(\"sdk \".concat(sdk));\n  var os = null;\n\n  try {\n    if (isReactNative()) {\n      os = getBrowserOS();\n      headerParts.push('platform ReactNative');\n    } else if (isNode()) {\n      os = getNodeOS();\n      headerParts.push(\"platform node.js/\".concat(getNodeVersion()));\n    } else {\n      os = getBrowserOS();\n      headerParts.push(\"platform browser\");\n    }\n  } catch (e) {\n    os = null;\n  }\n\n  if (os) {\n    headerParts.push(\"os \".concat(os));\n  }\n\n  return \"\".concat(headerParts.filter(function (item) {\n    return item !== '';\n  }).join('; '), \";\");\n}\n\n/**\n * Mixes in a method to return just a plain object with no additional methods\n * @private\n * @param {Object} data - Any plain JSON response returned from the API\n * @return {Object} Enhanced object with toPlainObject method\n */\n\nfunction toPlainObject(data) {\n  return Object.defineProperty(data, 'toPlainObject', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function value() {\n      return cloneDeep(this);\n    }\n  });\n}\n\nexport { createHttpClient, createRequestConfig, enforceObjPath, freezeSys, getUserAgentHeader, toPlainObject };\n"]},"metadata":{},"sourceType":"module"}